import{i as R,r as o,k as Q,d as p,c as d,j as e,B as n,I as c,p as $,C as D,ay as J}from"./index-BgzuCSKe.js";import{L as r}from"./label-CTTYbNyV.js";import{T as b}from"./textarea-LixU21-h.js";import{S as _,a as E,b as T,c as P,d as t}from"./select-DWk-BBhH.js";import{D as A,d as G,a as O,b as k,c as L}from"./dialog-AKCUCdMT.js";import{P as K}from"./plus-Bn2ZrHCv.js";import{T as W}from"./trash-2-nf0tJxYl.js";import{D as X}from"./download-BdUvxDmi.js";import"./index-BZrFsnjO.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=R("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);function de(){const[g,U]=o.useState(""),{isAdmin:u}=Q(),[F,I]=o.useState([]),[V,w]=o.useState(!1),[B,j]=o.useState(!1),[h,N]=o.useState(null),[x,v]=o.useState(!1),[a,l]=o.useState({title:"",description:"",download_url:"",version:"",category:""}),[f,y]=o.useState(null);o.useEffect(()=>{m()},[]);const m=async()=>{try{const s=await p("/softwares");I(s)}catch{d.error("Failed to load softwares")}},q=async()=>{if(!a.title){d.error("Title is required");return}v(!0);try{const s=new FormData;s.append("title",a.title),a.description&&s.append("description",a.description),a.download_url&&s.append("download_url",a.download_url),a.version&&s.append("version",a.version),a.category&&s.append("category",a.category),f&&s.append("cover",f),await p("/softwares",{method:"POST",body:s}),d.success("Software added successfully"),w(!1),S(),m()}catch(s){d.error(s.message||"Failed to add software")}finally{v(!1)}},M=async()=>{if(!h||!a.title){d.error("Title is required");return}try{await p(`/softwares/${h.id}`,{method:"PATCH",body:JSON.stringify({title:a.title,description:a.description,download_url:a.download_url,version:a.version,category:a.category})}),d.success("Software updated successfully"),j(!1),S(),m()}catch(s){d.error(s.message||"Failed to update software")}finally{v(!1)}},z=async s=>{if(confirm("Are you sure you want to delete this software?"))try{await p(`/softwares/${s}`,{method:"DELETE"}),d.success("Software deleted successfully"),m()}catch(i){d.error(i.message||"Failed to delete software")}},H=s=>{N(s),l({title:s.title,description:s.description||"",download_url:s.download_url||"",version:s.version||"",category:s.category||""}),j(!0)},S=()=>{l({title:"",description:"",download_url:"",version:"",category:""}),y(null),N(null)},C=F.filter(s=>{var i;return s.title.toLowerCase().includes(g.toLowerCase())||((i=s.description)==null?void 0:i.toLowerCase().includes(g.toLowerCase()))});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Software Library"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:u?"Manage software resources":"Browse available software"})]}),u&&e.jsxs(A,{open:V,onOpenChange:w,children:[e.jsx(G,{asChild:!0,children:e.jsxs(n,{className:"gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),"Add Software"]})}),e.jsxs(O,{className:"max-w-2xl",children:[e.jsx(k,{children:e.jsx(L,{children:"Add New Software"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Title *"}),e.jsx(c,{value:a.title,onChange:s=>l({...a,title:s.target.value}),placeholder:"e.g., Adobe Photoshop"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Description"}),e.jsx(b,{value:a.description,onChange:s=>l({...a,description:s.target.value}),placeholder:"Brief description of the software",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Version"}),e.jsx(c,{value:a.version,onChange:s=>l({...a,version:s.target.value}),placeholder:"e.g., 2024.1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Category"}),e.jsxs(_,{value:a.category,onValueChange:s=>l({...a,category:s}),children:[e.jsx(E,{children:e.jsx(T,{placeholder:"Select category"})}),e.jsxs(P,{children:[e.jsx(t,{value:"Design",children:"Design"}),e.jsx(t,{value:"Development",children:"Development"}),e.jsx(t,{value:"Productivity",children:"Productivity"}),e.jsx(t,{value:"Education",children:"Education"}),e.jsx(t,{value:"Utilities",children:"Utilities"}),e.jsx(t,{value:"Other",children:"Other"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Download URL"}),e.jsx(c,{value:a.download_url,onChange:s=>l({...a,download_url:s.target.value}),placeholder:"https://example.com/download"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Cover Image"}),e.jsx(c,{type:"file",accept:"image/*",onChange:s=>{var i;return y(((i=s.target.files)==null?void 0:i[0])||null)}})]}),e.jsx(n,{onClick:q,className:"w-full",disabled:x,children:x?"Adding...":"Add Software"})]})]})]})]}),e.jsxs("div",{className:"relative max-w-md",children:[e.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(c,{placeholder:"Search software...",value:g,onChange:s=>U(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[C.map(s=>e.jsxs(D,{className:"overflow-hidden hover:shadow-xl transition-all",children:[s.cover_image_url&&e.jsx("div",{className:"h-48 overflow-hidden bg-muted",children:e.jsx("img",{src:s.cover_image_url,alt:s.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold mb-1",children:s.title}),s.category&&e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-primary/10 text-primary",children:s.category})]}),u&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>H(s),children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>z(s.id),children:e.jsx(W,{className:"h-4 w-4"})})]})]}),s.version&&e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Version ",s.version]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-4 line-clamp-2",children:s.description}),s.download_url&&e.jsxs(n,{variant:"outline",className:"w-full gap-2",onClick:()=>window.open(s.download_url,"_blank"),children:[e.jsx(X,{className:"h-4 w-4"}),"Download"]})]})]},s.id)),C.length===0&&e.jsxs(D,{className:"p-12 text-center col-span-full",children:[e.jsx(J,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No software found"}),e.jsx("p",{className:"text-muted-foreground",children:u?"Add your first software to get started":"No software available yet"})]})]}),e.jsx(A,{open:B,onOpenChange:j,children:e.jsxs(O,{className:"max-w-2xl",children:[e.jsx(k,{children:e.jsx(L,{children:"Edit Software"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Title *"}),e.jsx(c,{value:a.title,onChange:s=>l({...a,title:s.target.value}),placeholder:"e.g., Adobe Photoshop"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Description"}),e.jsx(b,{value:a.description,onChange:s=>l({...a,description:s.target.value}),placeholder:"Brief description of the software",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Version"}),e.jsx(c,{value:a.version,onChange:s=>l({...a,version:s.target.value}),placeholder:"e.g., 2024.1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Category"}),e.jsxs(_,{value:a.category,onValueChange:s=>l({...a,category:s}),children:[e.jsx(E,{children:e.jsx(T,{placeholder:"Select category"})}),e.jsxs(P,{children:[e.jsx(t,{value:"Design",children:"Design"}),e.jsx(t,{value:"Development",children:"Development"}),e.jsx(t,{value:"Productivity",children:"Productivity"}),e.jsx(t,{value:"Education",children:"Education"}),e.jsx(t,{value:"Utilities",children:"Utilities"}),e.jsx(t,{value:"Other",children:"Other"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Download URL"}),e.jsx(c,{value:a.download_url,onChange:s=>l({...a,download_url:s.target.value}),placeholder:"https://example.com/download"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Cover Image"}),e.jsx(c,{type:"file",accept:"image/*",onChange:s=>{var i;return y(((i=s.target.files)==null?void 0:i[0])||null)}}),(h==null?void 0:h.cover_image_url)&&!f&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"Current image will be kept if no new image is uploaded"})]}),e.jsx(n,{onClick:M,className:"w-full",disabled:x,children:x?"Updating...":"Update Software"})]})]})})]})}export{de as default};
