import{i as Be,y as He,r as a,H as Ce,j as e,E as re,F as we,G as Oe,O as Ge,z as qe,t as ve,a0 as Ve,ai as z,Y as Se,B as v,d as B,c as L,a as Ye,Q as se,T as H,C as X,e as Q,f as K,b as Z,a2 as Ne,I as We,am as Xe}from"./index-BgzuCSKe.js";import{u as Qe}from"./index-BZrFsnjO.js";import{L as ye}from"./label-CTTYbNyV.js";import{T as Ke}from"./trash-2-nf0tJxYl.js";import{D as J}from"./download-BdUvxDmi.js";import{E as ee}from"./external-link-c6h32n81.js";import{U as Ze}from"./upload-_QSc8TW1.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=Be("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);var G="Checkbox",[es,fs]=He(G),[ss,ae]=es(G);function ts(s){const{__scopeCheckbox:t,checked:o,children:n,defaultChecked:i,disabled:c,form:m,name:b,onCheckedChange:l,required:N,value:y="on",internal_do_not_use_render:f}=s,[d,k]=qe({prop:o,defaultProp:i??!1,onChange:l,caller:G}),[h,g]=a.useState(null),[j,u]=a.useState(null),x=a.useRef(!1),C=h?!!m||!!h.closest("form"):!0,S={checked:d,disabled:c,setChecked:k,control:h,setControl:g,name:b,form:m,value:y,hasConsumerStoppedPropagationRef:x,required:N,defaultChecked:T(i)?!1:i,isFormControl:C,bubbleInput:j,setBubbleInput:u};return e.jsx(ss,{scope:t,...S,children:rs(f)?f(S):n})}var Ee="CheckboxTrigger",Me=a.forwardRef(({__scopeCheckbox:s,onKeyDown:t,onClick:o,...n},i)=>{const{control:c,value:m,disabled:b,checked:l,required:N,setControl:y,setChecked:f,hasConsumerStoppedPropagationRef:d,isFormControl:k,bubbleInput:h}=ae(Ee,s),g=Ce(i,y),j=a.useRef(l);return a.useEffect(()=>{const u=c==null?void 0:c.form;if(u){const x=()=>f(j.current);return u.addEventListener("reset",x),()=>u.removeEventListener("reset",x)}},[c,f]),e.jsx(re.button,{type:"button",role:"checkbox","aria-checked":T(l)?"mixed":l,"aria-required":N,"data-state":Te(l),"data-disabled":b?"":void 0,disabled:b,value:m,...n,ref:g,onKeyDown:we(t,u=>{u.key==="Enter"&&u.preventDefault()}),onClick:we(o,u=>{f(x=>T(x)?!0:!x),h&&k&&(d.current=u.isPropagationStopped(),d.current||u.stopPropagation())})})});Me.displayName=Ee;var ne=a.forwardRef((s,t)=>{const{__scopeCheckbox:o,name:n,checked:i,defaultChecked:c,required:m,disabled:b,value:l,onCheckedChange:N,form:y,...f}=s;return e.jsx(ts,{__scopeCheckbox:o,checked:i,defaultChecked:c,disabled:b,required:m,onCheckedChange:N,name:n,form:y,value:l,internal_do_not_use_render:({isFormControl:d})=>e.jsxs(e.Fragment,{children:[e.jsx(Me,{...f,ref:t,__scopeCheckbox:o}),d&&e.jsx(Le,{__scopeCheckbox:o})]})})});ne.displayName=G;var De="CheckboxIndicator",Pe=a.forwardRef((s,t)=>{const{__scopeCheckbox:o,forceMount:n,...i}=s,c=ae(De,o);return e.jsx(Oe,{present:n||T(c.checked)||c.checked===!0,children:e.jsx(re.span,{"data-state":Te(c.checked),"data-disabled":c.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...s.style}})})});Pe.displayName=De;var Fe="CheckboxBubbleInput",Le=a.forwardRef(({__scopeCheckbox:s,...t},o)=>{const{control:n,hasConsumerStoppedPropagationRef:i,checked:c,defaultChecked:m,required:b,disabled:l,name:N,value:y,form:f,bubbleInput:d,setBubbleInput:k}=ae(Fe,s),h=Ce(o,k),g=Qe(c),j=Ge(n);a.useEffect(()=>{const x=d;if(!x)return;const C=window.HTMLInputElement.prototype,D=Object.getOwnPropertyDescriptor(C,"checked").set,P=!i.current;if(g!==c&&D){const _=new Event("click",{bubbles:P});x.indeterminate=T(c),D.call(x,T(c)?!1:c),x.dispatchEvent(_)}},[d,g,c,i]);const u=a.useRef(T(c)?!1:c);return e.jsx(re.input,{type:"checkbox","aria-hidden":!0,defaultChecked:m??u.current,required:b,disabled:l,name:N,value:y,form:f,...t,tabIndex:-1,ref:h,style:{...t.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Le.displayName=Fe;function rs(s){return typeof s=="function"}function T(s){return s==="indeterminate"}function Te(s){return T(s)?"indeterminate":s?"checked":"unchecked"}const Re=a.forwardRef(({className:s,...t},o)=>e.jsx(ne,{ref:o,className:ve("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:e.jsx(Pe,{className:ve("flex items-center justify-center text-current"),children:e.jsx(Ve,{className:"h-4 w-4"})})}));Re.displayName=ne.displayName;function as({assignment:s,submission:t,attemptNumber:o,totalAttempts:n,onResubmit:i}){const[c,m]=a.useState(null),b=t.graded_at===null&&s.due_date&&new Date<new Date(s.due_date),l=o<n;a.useEffect(()=>{t.graded_by&&N()},[t.graded_by]);const N=async()=>{t.graded_by&&m("Instructor")},y=async()=>{if(confirm("Are you sure you want to delete this submission? You can resubmit before the deadline."))try{await B(`/submissions/${t.id}`,{method:"DELETE"}),L.success("Submission deleted. You can now resubmit."),i&&i()}catch(h){console.error("Error deleting submission:",h),L.error("Failed to delete submission")}},d=(()=>{if(!t.submitted_at||!s.due_date)return null;const h=new Date(t.submitted_at),j=new Date(s.due_date).getTime()-h.getTime(),u=Math.floor(j/(1e3*60*60)),x=Math.floor(j%(1e3*60*60)/(1e3*60));if(j<0){const C=Math.abs(u),S=Math.abs(x);return{text:`Assignment was submitted ${C} hours ${S} mins late`,isLate:!0}}return{text:`Assignment was submitted ${u} hours ${x} mins early`,isLate:!1}})(),k=t.file_path?t.file_path.split("/").pop():null;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:s.title}),e.jsx("div",{className:"flex flex-col gap-2 text-sm text-muted-foreground sm:flex-row sm:gap-4",children:s.due_date&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Opened:"})," ",z(new Date(s.due_date),"EEEE, MMMM d, yyyy, h:mm a")]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Due:"})," ",z(new Date(s.due_date),"EEEE, MMMM d, yyyy, h:mm a")]})]})})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Submission Status"}),e.jsx("div",{className:"border rounded-lg overflow-x-auto",children:e.jsx("table",{className:"w-full min-w-[560px]",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-3 px-4 font-medium bg-muted/50 w-48",children:"Attempt number"}),e.jsxs("td",{className:"py-3 px-4",children:["This is attempt ",o," of ",n,"."]})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-3 px-4 font-medium bg-muted/50",children:"Submission status"}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"inline-block px-3 py-1 rounded bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200",children:t.status==="submitted"?"Submitted for grading":t.status||"Not submitted"})})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-3 px-4 font-medium bg-muted/50",children:"Grading status"}),e.jsx("td",{className:"py-3 px-4",children:t.graded_at?e.jsxs("span",{children:["Graded - ",t.marks_obtained,"/",s.points," points"]}):e.jsx("span",{children:"Not graded"})})]}),d&&e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-3 px-4 font-medium bg-muted/50",children:"Time remaining"}),e.jsx("td",{className:`py-3 px-4 ${d.isLate?"bg-red-100 dark:bg-red-900/30":"bg-green-100 dark:bg-green-900/30"}`,children:d.text})]}),t.submitted_at&&e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-3 px-4 font-medium bg-muted/50",children:"Last modified"}),e.jsx("td",{className:"py-3 px-4",children:z(new Date(t.submitted_at),"EEEE, MMMM d, yyyy, h:mm a")})]}),k&&e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-3 px-4 font-medium bg-muted/50",children:"File submissions"}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4"}),e.jsx("span",{children:k}),t.submitted_at&&e.jsx("span",{className:"text-muted-foreground text-sm ml-2",children:z(new Date(t.submitted_at),"MMMM d yyyy, h:mm a")})]})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 font-medium bg-muted/50",children:"Submission comments"}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("button",{className:"text-primary hover:underline",children:"Comments (0)"})})]})]})})}),t.graded_at&&e.jsxs("div",{className:"mt-6 border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Feedback"}),e.jsx("div",{className:"border rounded-lg overflow-x-auto",children:e.jsx("table",{className:"w-full min-w-[560px]",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-3 px-4 font-medium bg-muted/50 w-48",children:"Grade"}),e.jsxs("td",{className:"py-3 px-4",children:[t.marks_obtained," / ",s.points]})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-3 px-4 font-medium bg-muted/50",children:"Graded on"}),e.jsx("td",{className:"py-3 px-4",children:z(new Date(t.graded_at),"EEEE, MMMM d, yyyy, h:mm a")})]}),t.graded_by&&e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-3 px-4 font-medium bg-muted/50",children:"Graded by"}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx("span",{className:"inline-block px-2 py-0.5 rounded bg-muted text-xs",children:"BY"}),e.jsx("span",{children:c||"Instructor"})]})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 px-4 font-medium bg-muted/50",children:"Feedback comments"}),e.jsx("td",{className:"py-3 px-4",children:t.feedback||"No feedback provided"})]})]})})})]}),(b||l)&&e.jsx("div",{className:"mt-6 pt-6 border-t",children:e.jsxs("div",{className:"flex flex-col gap-3 p-4 bg-muted/50 rounded-lg sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium",children:l?`You have ${n-o} attempt(s) remaining`:"Want to resubmit?"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l?"You can submit again before the deadline.":"You can delete this submission and upload a new one before the deadline."})]}),b&&e.jsxs(v,{variant:"destructive",onClick:y,className:"sm:ml-4",children:[e.jsx(Ke,{className:"h-4 w-4 mr-2"}),"Delete Submission"]}),l&&!b&&e.jsx(v,{onClick:i,className:"sm:ml-4",children:"Submit Again"})]})})]})]})}const oe=s=>s&&s.toLowerCase().split(".").pop()||"",ns=s=>["doc","docx"].includes(oe(s)),os=s=>["xls","xlsx"].includes(oe(s)),ke=(s,t,o)=>Math.max(t,Math.min(o,s)),_e=s=>{if(!s)return!1;try{const t=new URL(s),o=t.hostname.toLowerCase();return!(!/^https?:$/i.test(t.protocol)||["localhost","127.0.0.1"].includes(o)||/^10\./.test(o)||/^192\.168\./.test(o)||/^172\.(1[6-9]|2[0-9]|3[0-1])\./.test(o))}catch{return!1}},cs=s=>`https://docs.google.com/gview?embedded=1&url=${encodeURIComponent(s)}`,te=s=>{if(!s)return"";const t=s.trim();return/^https?:\/\//i.test(t)?t:/^(drive|docs)\.google\.com/i.test(t)?`https://${t}`:t},$e=s=>{const t=s.pathname.match(/\/file\/d\/([^/]+)/);if(t!=null&&t[1])return t[1];const o=s.searchParams.get("id");return o||(s.pathname.includes("/uc")?s.searchParams.get("id"):null)||""},is=s=>{const t=te(s);if(!t)return"";try{const o=new URL(t),n=o.hostname.toLowerCase();if(n.includes("drive.google.com")){const i=$e(o);return i?`https://drive.google.com/file/d/${i}/preview?usp=sharing&embedded=true`:t}if(n.includes("docs.google.com")){const i=o.pathname.match(/\/(document|presentation|spreadsheets|forms)\/d\/([^/]+)/),c=(i==null?void 0:i[1])||"",m=(i==null?void 0:i[2])||"";return c&&m?`https://docs.google.com/${c}/d/${m}/preview?usp=sharing&embedded=true`:t}return""}catch{return""}};function ds({url:s,fileId:t,initialScale:o=1.25}){const n=a.useRef(null),[i,c]=a.useState(!0),[m,b]=a.useState(null),[l,N]=a.useState(o),[y,f]=a.useState(0);return a.useLayoutEffect(()=>{f(d=>d+1)},[s]),a.useEffect(()=>{let d=!1;async function k(){if(c(!0),b(null),!s){c(!1);return}const h=n.current;if(h)try{const g=await Xe(()=>import("./pdf-ftNvnhDM.js"),[]);g.GlobalWorkerOptions.workerSrc="/pdf.worker.min.js";const j=se(),u=j?{Authorization:`Bearer ${j}`}:{},x=s||(t?`${H}/materials/${t}/file`:"");if(!x)throw new Error("PDF URL missing");const C=await fetch(x,{credentials:"include",headers:u});if(!C.ok)throw new Error(`HTTP ${C.status}`);const S=await C.arrayBuffer(),D=await g.getDocument({data:S}).promise;h.innerHTML="";for(let P=1;P<=D.numPages;P+=1){if(d)return;const _=await D.getPage(P),E=_.getViewport({scale:l}),M=document.createElement("canvas"),I=M.getContext("2d");M.width=E.width,M.height=E.height,M.style.display="block",M.style.margin="0 auto 16px auto",h.appendChild(M),await _.render({canvasContext:I,viewport:E}).promise}c(!1)}catch(g){b((g==null?void 0:g.message)||"Failed to render PDF"),c(!1)}}return k(),()=>{d=!0,n.current&&(n.current.innerHTML="")}},[s,l,y]),e.jsxs("div",{className:"w-full h-full overflow-auto",children:[e.jsxs("div",{className:"sticky top-0 z-10 flex gap-2 items-center justify-end p-2 border-b bg-background",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>N(d=>ke(Math.round((d-.1)*10)/10,.5,3)),children:"-"}),e.jsxs("span",{className:"text-xs text-muted-foreground w-10 text-center",children:[Math.round(l*100),"%"]}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>N(d=>ke(Math.round((d+.1)*10)/10,.5,3)),children:"+"})]}),m?e.jsx("div",{className:"flex flex-col items-center justify-center h-[60vh] gap-3 p-8",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["PDF preview failed: ",m]})}):e.jsxs(e.Fragment,{children:[i&&e.jsx("div",{className:"flex items-center justify-center p-6",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-primary"})}),e.jsx("div",{ref:n,className:"px-2 pb-8"})]})]})}function gs({file:s,onAssignmentSubmitted:t}){const{user:o}=Ye(),[n,i]=a.useState(""),[c,m]=a.useState(!0),[b,l]=a.useState(""),[N,y]=a.useState(!1),[f,d]=a.useState(null),[k,h]=a.useState(!1),[g,j]=a.useState(!1),[u,x]=a.useState([]),[C,S]=a.useState(!1),[D,P]=a.useState((s==null?void 0:s.attempts)||2),_=`${(s==null?void 0:s.file_path)||""}|${(s==null?void 0:s.title)||""}`,E=(s==null?void 0:s.file_path)||(s==null?void 0:s.link_url)||(s==null?void 0:s.url)||"",M=a.useMemo(()=>/pdf/i.test((s==null?void 0:s.file_type)||"")||oe(_)==="pdf",[s,_]),I=a.useMemo(()=>/video/i.test((s==null?void 0:s.file_type)||""),[s]),ce=a.useMemo(()=>/image/i.test((s==null?void 0:s.file_type)||""),[s]),A=a.useMemo(()=>/text\/html/i.test((s==null?void 0:s.file_type)||""),[s]),R=a.useMemo(()=>{const r=E||"";return(s==null?void 0:s.file_type)==="google_drive"||/drive\.google\.com|docs\.google\.com/i.test(r)},[s,E]),ie=R?is(E)||te(E):"",de=a.useMemo(()=>{if(!R||!E)return"";try{const r=te(E),p=new URL(r);return p.hostname.toLowerCase().includes("drive.google.com")?$e(p):""}catch{return""}},[E,R]),q=de?`https://drive.google.com/uc?export=download&id=${de}`:"",le=se(),me=s!=null&&s.id&&le?`${H}/materials/${s.id}/file?token=${encodeURIComponent(le)}`:"",O=me||n,ue=O?`${O}${O.includes("#")?"":"#view=FitH"}`:"",V=_e(n),$=n?`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(n)}`:"",xe=a.useMemo(()=>{const r=(s==null?void 0:s.file_type)||"";return/msword|vnd\.openxmlformats-officedocument\.wordprocessingml\.document|application\/document/i.test(r)||ns(_)},[s,_]),he=a.useMemo(()=>{const r=(s==null?void 0:s.file_type)||"";return/vnd\.ms-excel|vnd\.openxmlformats-officedocument\.spreadsheetml\.sheet/i.test(r)||os(_)},[s,_]),pe=a.useMemo(()=>{const r=(s==null?void 0:s.file_type)||"";return/powerpoint|presentation|vnd\.ms-powerpoint|vnd\.openxmlformats-officedocument\.presentationml\.presentation/i.test(r)||/\.(ppt|pptx)$/i.test(_)},[s,_]),U=b||(s==null?void 0:s.description)||"",Ie=a.useMemo(()=>/<\/?[a-z][\s\S]*>/i.test(U),[U]),be=async()=>{if(!s||!s.file_path&&!s.id){m(!1);return}try{let r=s.file_path||"";const p=r?/^https?:\/\//i.test(r):!1;if(s.id&&!p?r=(await B(`/materials/${s.id}/signed-url`)).url:!r&&s.id&&(r=`${H}/materials/${s.id}/file`),!r)throw new Error("File URL missing");i(Ne(r))}catch(r){console.error("File load failed",r),L.error("Failed to load file")}finally{m(!1)}},Ae=async()=>{if(!(!s||!A)){if(!s.id){l(s.description||"");return}try{y(!0);const r=se(),p=r?`${H}/materials/${s.id}/file?token=${encodeURIComponent(r)}`:`${H}/materials/${s.id}/file`,w=await fetch(p,{credentials:"include"});if(!w.ok)throw new Error(`HTTP ${w.status}`);const F=await w.text();l(F)}catch(r){console.error("Text lesson load failed",r),l(s.description||"")}finally{y(!1)}}},Y=async()=>{if(!(!s||!s._isAssignment||!o))try{const r=await B("/submissions?mine=true");x((r||[]).filter(p=>p.assignment_id===s.id))}catch{}},Ue=async()=>{if(!(!s||!s._isAssignment||!(o!=null&&o.id)))try{const r=await B(`/assignments/${s.id}/attempts`);r!=null&&r.attempts&&P(r.attempts)}catch{}},W=()=>{if(s)try{const r=document.createElement("a");r.href=q||n||me,r.download=s.title||"download",r.rel="noopener",r.target="_blank",r.click()}catch{L.error("Failed to download file")}},fe=(r,p,w={})=>{if(!p)return null;const F=(s==null?void 0:s.title)||r;return e.jsxs("div",{className:"flex flex-col h-full min-h-0 gap-0 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-3 border-b border-border/50",children:[e.jsx("span",{className:"text-sm font-semibold text-foreground",children:F}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[$&&e.jsx(v,{asChild:!0,size:"sm",variant:"outline",className:"px-3 py-1",children:e.jsx("a",{href:$,target:"_blank",rel:"noreferrer",children:"Open in Office"})}),n&&e.jsx(v,{asChild:!0,size:"sm",variant:"outline",className:"px-3 py-1",children:e.jsx("a",{href:n,download:!0,children:"Download"})})]})]}),e.jsx("iframe",{src:p,className:"w-full flex-1 min-h-0 border-0 bg-white",title:`Preview of ${F}`,allow:"autoplay; fullscreen",allowFullScreen:!0}),w.showPrivateWarning&&e.jsx("div",{className:"px-6 py-2 border-t border-border/50 text-xs text-muted-foreground",children:"Microsoft's viewer requires a publicly accessible link; open in a new tab if it does not load."})]})},ze=async()=>{if(!s||!s._isAssignment||!f){L.error("Please select a file to submit");return}if(!k){L.error("Please confirm that this submission is your own work");return}j(!0);try{if(!o)throw new Error("Not authenticated");const r=new FormData;r.append("file",f),s.course_id&&r.append("course_id",s.course_id),await B(`/assignments/${s.id}/submit`,{method:"POST",body:r}),L.success("Assignment submitted successfully!"),d(null),S(!1),h(!1),await Y(),t==null||t()}catch(r){L.error(r.message||"Failed to submit assignment")}finally{j(!1)}};if(a.useEffect(()=>{s&&(!s._isAssignment&&!s._isQuiz&&(R?m(!1):s.file_path&&s.file_path.includes(".")?be():s._isBrief||be()),s._isAssignment&&(Y(),P(s.attempts||2),Ue()),m(!0),A?Ae():l(""))},[s==null?void 0:s.id,R,A]),!s)return e.jsx("div",{className:"h-full flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center p-12",children:[e.jsx(Je,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No file selected"}),e.jsx("p",{className:"text-muted-foreground",children:"Select a file from the sidebar to view it here"})]})});if(s._isQuiz&&s.quiz_url)return e.jsxs("div",{className:"h-full flex flex-col bg-background",children:[e.jsxs("div",{className:"p-4 border-b bg-card",children:[e.jsx("h2",{className:"text-2xl font-bold",children:s.title}),s.description&&e.jsx("p",{className:"text-muted-foreground mt-1",children:s.description})]}),e.jsx("div",{className:"flex-1",children:e.jsx("iframe",{src:s.quiz_url,className:"w-full h-full border-0",title:s.title,allow:"fullscreen; autoplay",sandbox:"allow-scripts allow-same-origin allow-forms allow-popups"})})]});if(s._isBrief){const r=_e(n),p=M,w=n?r?cs(n):n:"";return e.jsxs("div",{className:"h-full flex flex-col bg-background",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between bg-background sticky top-0 z-10",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.title}),s.file_path&&s.file_path.includes(".")&&e.jsxs(v,{variant:"outline",size:"sm",onClick:W,children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Download Brief"]})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:s.file_path&&s.file_path.includes(".")?p?e.jsxs(e.Fragment,{children:[e.jsx(ds,{url:n}),w&&e.jsx("div",{className:"p-4 border-t bg-background flex justify-center",children:e.jsx(v,{asChild:!0,size:"sm",variant:"outline",className:"gap-2",children:e.jsxs("a",{href:w,target:"_blank",rel:"noreferrer",className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Open in Google Viewer"]})})})]}):e.jsxs("div",{className:"p-8 flex flex-col items-center justify-center gap-3 text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"This document cannot be rendered inline; open it externally instead."}),w&&e.jsx(v,{asChild:!0,variant:"outline",children:e.jsxs("a",{href:w,target:"_blank",rel:"noreferrer",className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Open Document"]})})]}):e.jsx("div",{className:"w-full h-full p-8",children:e.jsxs(X,{className:"h-full",children:[e.jsx(Q,{children:e.jsx(K,{children:"Assessment Brief"})}),e.jsx(Z,{children:e.jsx("div",{className:"prose dark:prose-invert max-w-none",children:e.jsx("p",{className:"whitespace-pre-wrap",children:s.assessment_brief||s.description||"No brief content available"})})})]})})})]})}if(s._isAssignment){const r=u.length>0?u[0]:null,p=u.length,w=p<D;return r&&(!C||!w)?e.jsx("div",{className:"h-full overflow-auto bg-background",children:e.jsx("div",{className:"w-full h-full p-8",children:e.jsx(as,{assignment:{id:s.id||"",title:s.title,due_date:s.due_date||null,points:s.points||100,attempts:s.attempts||2},submission:r,attemptNumber:p,totalAttempts:D,onResubmit:()=>{w?S(!0):(x([]),Y())}})})}):e.jsx("div",{className:"h-full overflow-auto bg-background",children:e.jsxs("div",{className:"w-full h-full p-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold mb-2",children:s.title}),s.description&&e.jsx("p",{className:"text-muted-foreground",children:s.description}),e.jsxs("div",{className:"flex gap-4 mt-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Total Marks:"})," ",s.points]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Passing Marks:"})," ",s.passing_marks]}),s.due_date&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Due:"})," ",new Date(s.due_date).toLocaleDateString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Attempts:"})," ",p,"/",D]})]})]}),s.rubrics&&e.jsxs(X,{className:"mb-6",children:[e.jsx(Q,{children:e.jsx(K,{children:"Rubrics"})}),e.jsx(Z,{children:e.jsx("div",{className:"prose dark:prose-invert max-w-none whitespace-pre-wrap",children:s.rubrics})})]}),s.rubrics_file_url&&e.jsxs("div",{className:"mb-6 flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("a",{href:Ne(s.rubrics_file_url),target:"_blank",rel:"noreferrer",className:"underline",children:"Download Rubrics File"})]}),r&&C&&e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsxs("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:["Submitting attempt ",p+1," of ",D]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>S(!1),className:"mt-2",children:"View Previous Submission"})]}),e.jsxs(X,{children:[e.jsx(Q,{children:e.jsx(K,{children:"Submit Assignment"})}),e.jsxs(Z,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(ye,{htmlFor:"file-upload",children:"Choose File"}),e.jsx(We,{id:"file-upload",type:"file",onChange:F=>{var je;d(((je=F.target.files)==null?void 0:je[0])||null),h(!1)}})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Re,{checked:k,onCheckedChange:F=>h(!!F),id:"confirm-submission"}),e.jsx(ye,{htmlFor:"confirm-submission",className:"text-sm",children:"I confirm that this is my work done by understanding the assignment requirements."})]}),e.jsxs(v,{onClick:ze,disabled:!f||g||!k,className:"w-full",children:[e.jsx(Ze,{className:"h-4 w-4 mr-2"}),g?"Submitting...":"Submit Assignment"]})]})]})]})})}const ge=R&&!!ie;return e.jsxs("div",{className:"h-full flex flex-col bg-background",children:[!M&&e.jsxs("div",{className:"p-4 border-b flex items-center justify-between bg-background sticky top-0 z-10",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.title}),e.jsxs(v,{variant:"outline",size:"sm",onClick:W,children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Download"]})]}),e.jsxs("div",{className:"flex-1 overflow-auto relative",children:[ge?I&&q?e.jsx("div",{className:"flex items-center justify-center h-full w-full p-6",children:e.jsx("video",{src:q,controls:!0,className:"w-full h-full rounded-lg shadow-lg object-contain"})}):e.jsx("iframe",{src:ie,className:"absolute inset-0 w-full h-full border-0",title:s.title,onLoad:()=>m(!1),allow:"autoplay; fullscreen",allowFullScreen:!0}):null,M&&ue&&e.jsxs("div",{className:"flex flex-col h-full min-h-0 gap-0 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-3 border-b border-border/50",children:[e.jsx("span",{className:"text-sm font-semibold text-foreground",children:(s==null?void 0:s.title)||"Document"}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[V&&$&&e.jsx(v,{asChild:!0,size:"sm",variant:"outline",className:"px-3 py-1",children:e.jsx("a",{href:$,target:"_blank",rel:"noreferrer",children:"Open in Office"})}),e.jsx(v,{asChild:!0,size:"sm",variant:"outline",className:"px-3 py-1",children:e.jsx("a",{href:O,download:!0,children:"Download"})})]})]}),e.jsx("iframe",{src:ue,className:"w-full flex-1 min-h-0 border-0",title:`Preview of ${(s==null?void 0:s.title)||"Document"}`,allow:"autoplay; fullscreen",allowFullScreen:!0})]}),I&&n&&e.jsx("div",{className:"flex items-center justify-center h-full w-full p-6",children:e.jsx("video",{src:n,controls:!0,className:"w-full h-full rounded-lg shadow-lg object-contain"})}),ce&&n&&e.jsx("div",{className:"flex items-center justify-center h-full w-full p-6",children:e.jsx("img",{src:n,alt:s.title,className:"w-full h-full object-contain rounded-lg shadow-lg"})}),A&&e.jsx("div",{className:"w-full h-full px-6 py-8 md:px-10",children:N?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):U?Ie?e.jsx("div",{className:`mx-auto max-w-4xl prose prose-2xl text-black
                    prose-headings:tracking-tight prose-headings:mt-6 prose-headings:mb-3
                    prose-headings:text-black prose-p:text-black prose-li:text-black prose-a:text-black prose-strong:text-black prose-em:text-black
                    prose-p:leading-relaxed prose-p:my-3 prose-li:my-2
                    [&_iframe]:w-full [&_iframe]:aspect-video [&_iframe]:rounded-lg [&_iframe]:border-0
                    [&_video]:w-full [&_video]:max-w-full [&_video]:h-auto [&_video]:rounded-lg [&_video]:shadow-lg
                    [&_img]:max-w-full [&_img]:h-auto [&_img]:rounded-lg`,dangerouslySetInnerHTML:{__html:U}}):e.jsx("div",{className:"mx-auto max-w-4xl whitespace-pre-wrap text-base leading-relaxed text-black",children:U}):e.jsx("div",{className:"mx-auto max-w-4xl text-sm text-black",children:"No text lesson content available."})}),pe&&n&&fe((s==null?void 0:s.title)||"Presentation",$,{showPrivateWarning:!V}),(xe||he)&&n&&fe((s==null?void 0:s.title)||"Document",$,{showPrivateWarning:!V}),!ge&&!M&&!I&&!ce&&!A&&!pe&&!(xe||he)&&e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center p-12",children:[e.jsx(Se,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Preview not available for this file type"}),e.jsxs(v,{onClick:W,children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Download to view"]})]})})]})]})}export{gs as F,ds as I,Je as a};
