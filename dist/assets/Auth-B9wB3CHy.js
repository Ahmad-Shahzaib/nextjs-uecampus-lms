import{u as I,a as _,r as o,j as e,C as F,b as T,I as k,B as h,c as a,d as U,A as q}from"./index-BgzuCSKe.js";import{L as E}from"./label-CTTYbNyV.js";import{M as B}from"./mail-BUDPvNNM.js";import{L as M,o as $,s as C,Z as z}from"./types-ZO532POI.js";import{E as K}from"./eye-off-B3qo4MnK.js";import{E as O}from"./eye-AaGJ7QJb.js";const Z="/assets/ue-campus-logo-CcgQUPWm.png",D=$({email:C().email("Invalid email address").trim().toLowerCase(),password:C().min(6,"Password must be at least 6 characters")}),i="";function J(){const c=I(),{login:L}=_(),[n,p]=o.useState(!1),[w,d]=o.useState(""),[g,m]=o.useState(""),[x,S]=o.useState(!1),[P,u]=o.useState(0),A=async r=>{var b,j,y;r.preventDefault(),r.stopPropagation(),a.dismiss(),p(!0);try{const s=D.parse({email:w,password:g}),t=await U("/auth/login",{method:"POST",body:{email:s.email,password:s.password}});if(!t||!t.token)throw new Error("Authentication failed: No token received");const N=t.user??{id:"self",email:s.email,full_name:"",avatar_url:"",is_blocked:!1},v=await L(t.token,{user:N,roles:t.roles});if(v){if(N.is_blocked){a.error("This account is blocked. Contact an administrator."),d(""),m(""),u(l=>l+1),c(i?`${i}/blocked`:"/blocked",{replace:!0});return}a.success("Login successful!"),d(""),m(""),u(l=>l+1);const f=i?`${i}/dashboard`:"/dashboard";c(f,{replace:!0})}else throw new Error("Login failed after token set");if(v){a.success("Login successful!"),d(""),m(""),u(l=>l+1);const f=i?`${i}/dashboard`:"/dashboard";c(f,{replace:!0})}else throw new Error("Login failed after token set")}catch(s){u(t=>t+1),s instanceof z?a.error(s.errors[0].message):s instanceof q&&s.status===403?(a.error("Your account is blocked. Contact an administrator."),c("/blocked",{replace:!0})):(b=s.message)!=null&&b.includes("401")||(j=s.message)!=null&&j.includes("Invalid credentials")?a.error("Invalid email or password"):(y=s.message)!=null&&y.includes("Network")?a.error("Network error. Please check your connection."):a.error(s.message||"Failed to sign in. Please try again.")}finally{p(!1)}};return e.jsxs("div",{className:"relative min-h-screen flex overflow-hidden bg-[#191c3b]",children:[e.jsx("div",{className:"absolute inset-0 bg-white",style:{clipPath:"polygon(0 0, 100% 0, 50% 100%, 0 100%)"}}),e.jsx("div",{className:"hidden lg:flex w-1/2 relative",children:e.jsxs("div",{className:"flex flex-col justify-center px-20 xl:px-28 w-full",children:[e.jsx("div",{className:"flex justify-start",children:e.jsx("img",{src:Z,alt:"UE Campus",className:"h-20 w-auto mb-16"})}),e.jsxs("div",{className:"space-y-6 text-[#1f1f1f]",children:[e.jsx("div",{className:"h-1 w-14 bg-[#5b4bdf]"}),e.jsxs("h2",{className:"text-5xl font-bold leading-tight",children:["Study anywhere",e.jsx("br",{}),"Achieve everywhere"]})]})]})}),e.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center px-6 lg:px-12 py-16 relative z-10",children:e.jsx(F,{className:"w-full max-w-lg bg-[#191c3b] border border-white/10 text-white shadow-2xl",children:e.jsxs(T,{className:"pt-8 pb-10 px-8 space-y-6",children:[e.jsx("p",{className:"text-2xl font-semibold",children:"Log in to your account"}),e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{className:"flex items-center gap-2 text-white/80",children:[e.jsx(B,{className:"h-4 w-4"}),"Email"]}),e.jsx(k,{type:"email",value:w,onChange:r=>d(r.target.value),required:!0,disabled:n,className:"bg-white text-black"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(E,{className:"flex items-center gap-2 text-white/80",children:[e.jsx(M,{className:"h-4 w-4"}),"Password"]}),e.jsx(h,{type:"button",variant:"ghost",size:"sm",onClick:()=>S(!x),className:"h-8 px-2 text-white",children:x?e.jsx(K,{className:"h-3 w-3"}):e.jsx(O,{className:"h-3 w-3"})})]}),e.jsx(k,{type:x?"text":"password",value:g,onChange:r=>m(r.target.value),required:!0,disabled:n,className:"bg-white text-black"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(h,{type:"button",variant:"link",className:"text-xs text-white/60 px-0",onClick:()=>a.info("Use your administrator to reset your password."),children:"Forgot your password?"})}),e.jsx(h,{type:"submit",className:"w-full bg-[#6a1b9a] hover:bg-[#591782] text-white",disabled:n,children:n?"Signing in...":"Login"}),e.jsx(h,{type:"button",className:"w-full bg-[#6a1b9a] hover:bg-[#591782] text-white",onClick:()=>window.open("https://www.uecampus.com/enquire-now","_blank"),children:"Signup"}),e.jsx("p",{className:"text-xs text-white/60 text-center pt-2",children:"Need access? Contact your administrator."})]},P)]})})})]})}export{J as default};
